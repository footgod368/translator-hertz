// Code generated by hertz generator.

package translator

import (
	"context"
	"github.com/cloudwego/hertz-examples/bizdemo/hertz_gorm/biz/service/complete"

	translator "github.com/cloudwego/hertz-examples/bizdemo/hertz_gorm/biz/hertz_gen/translator"
	"github.com/cloudwego/hertz-examples/bizdemo/hertz_gorm/biz/service"

	"github.com/cloudwego/hertz/pkg/app"
)

// TranslateText .
// @router /v1/translate [GET]
func TranslateText(ctx context.Context, c *app.RequestContext) {
	var err error
	var req translator.TranslateRequest
	err = c.BindAndValidate(&req)
	if err != nil {
		c.String(400, err.Error())
		return
	}

	// 记录查询记录
	_ = service.CreateQueryRecord(ctx, req.Text, c.ClientIP(), string(c.UserAgent()))

	// 翻译
	resp, err := service.Translate(ctx, req)
	if err != nil {
		c.String(500, err.Error())
		return
	}
	c.JSON(200, resp)
}

// Complete .
// @router /v1/complete [GET]
func Complete(ctx context.Context, c *app.RequestContext) {
	var err error
	var req translator.CompleteRequest
	err = c.BindAndValidate(&req)
	if err != nil {
		c.String(400, err.Error())
		return
	}

	resp, err := complete.Complete(ctx, req)
	if err != nil {
		c.String(500, err.Error())
		return
	}
	c.JSON(200, resp)
}

// DuckSay .
// @router /v1/duck_say [GET]
func DuckSay(ctx context.Context, c *app.RequestContext) {
	var err error
	var req translator.DuckSayRequest
	err = c.BindAndValidate(&req)
	if err != nil {
		c.String(400, err.Error())
		return
	}

	resp, err := service.DuckSay(ctx, req)
	if err != nil {
		c.String(500, err.Error())
		return
	}
	c.JSON(200, resp)
}
